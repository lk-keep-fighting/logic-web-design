{"type":"page","body":[{"type":"crud","syncLocation":false,"api":{"method":"post","url":"/api/ide/data/logic_instance/query","requestAdaptor":"var json = {\n  \"selects\": [\n    { \"column\": \"id\" },\n    { \"column\": \"env\" },\n    { \"column\": \"nextName\" },\n    { \"column\": \"bizId\" },\n    { \"column\": \"duration\" },\n    { \"column\": \"logicId\" },\n    { \"column\": \"parentLogicId\" },\n    { \"column\": \"parentBizId\" },\n    { \"column\": \"version\" },\n    { \"column\": \"serverTime\" },\n    { \"column\": \"startTime\" },\n    { \"column\": \"stopTime\" },\n    { \"column\": \"message\" },\n    { \"column\": \"success\" },\n    { \"column\": \"isRunning\" },\n    { \"column\": \"paramsJson\" },\n    { \"column\": \"isOver\" },\n    { \"column\": \"logicName\" },\n    { \"column\": \"retryTimes\" },\n    { \"column\": \"createTime\" },\n    { \"column\": \"isAsync\" }\n  ],\n  \"from\": {\n    \"mainTable\": \"logic_instance\",\n    \"joins\": [\n      {\n        \"type\": \"LEFT\",\n        \"table\": \"logic\",\n        \"on\": [\n          {\n            \"column1\": \"logicId\",\n            \"type\": \"=\",\n            \"column2\": \"logic_id\"\n          }\n        ]\n      }\n    ],\n    \"columnMap\": {\n      \"id\": { \"table\": \"logic_instance\" },\n      \"logicId\": {},\n      \"logic_id\": { \"table\": \"logic\", \"storeColumn\": \"id\" },\n      \"env\": {},\n      \"message\": {},\n      \"paramsJson\": {},\n      \"success\": {},\n      \"version\": { \"table\": \"logic_instance\" },\n      \"returnData\": {},\n      \"isOver\": {},\n      \"logicName\": {\n        \"table\": \"logic\", \"storeColumn\": \"name\"\n      }\n    },\n    \"nextName\": {},\n    \"bizId\": {},\n    \"serverTime\": {}\n  },\n  \"conditions\": [],\n  \"orderBy\": {\n    \"columns\": [\n      {\n        \"column\": \"serverTime\",\n        \"direction\": \"DESC\"\n      }\n    ]\n  }\n}\n\nif (context.logicId) {\n  json.conditions.push(\n    { column: 'logicId', value: context.logicId ?? '', operator: '=' },\n  )\n}\nif (context.logicName) {\n  json.conditions.push(\n    { column: 'logicName', value: context.logicName ?? '', operator: 'like' },\n  )\n}\nif (context.paramsJson) {\n  json.conditions.push(\n    { column: 'paramsJson', value: context.paramsJson ?? '', operator: 'like' },\n  )\n}\nif (context.env) {\n  json.conditions.push(\n    { column: 'env', value: context.env ?? '', operator: '=' },\n  )\n}\nif (context.bizId) {\n  json.conditions.push(\n    { column: 'bizId', value: context.bizId ?? '', operator: '=' },\n  )\n}\nif (context.bizIdLike) {\n  json.conditions.push(\n    { column: 'bizId', value: context.bizIdLike ?? '', operator: 'like' },\n  )\n}\nif (context.message) {\n  json.conditions.push(\n    { column: 'message', value: context.message ?? '', operator: 'like' },\n  )\n}\nif (context.startTime) {\n  json.conditions.push(\n    { column: 'serverTime', value: context.startTime ?? '', operator: '>' },\n  )\n}\nif (context.overTime) {\n  json.conditions.push(\n    { column: 'serverTime', value: context.overTime ?? '', operator: '<' },\n  )\n}\nswitch (context.success) {\n  case \"1\":\n    json.conditions.push(\n      { column: 'success', value: '1', operator: '=' },\n    )\n    break;\n  case \"0\":\n    json.conditions.push(\n      { column: 'success', value: '1', operator: '<>' },\n    )\n    break;\n  default:\n    break;\n}\nswitch (context.isAsync) {\n  case \"1\":\n    json.conditions.push(\n      { column: 'isAsync', value: '1', operator: '=' },\n    )\n    break;\n  case \"0\":\n    json.conditions.push(\n      { column: 'isAsync', value: '1', operator: '<>' },\n    )\n    break;\n  default:\n    break;\n}\nswitch (context.isOver) {\n  case \"1\":\n    json.conditions.push(\n      { column: 'isOver', value: '1', operator: '=' },\n    )\n    break;\n  case \"0\":\n    json.conditions.push(\n      { column: 'isOver', value: '1', operator: '<>' },\n    )\n    break;\n  default:\n    break;\n}\nswitch (context.isParent) {\n  case \"main\":\n    json.conditions.push(\n      { column: 'parentBizId', operator: 'IS NULL' },\n    )\n    break;\n  default:\n    break;\n}\n\napi.data = json;\napi.data.page = context.page;\napi.data.pageSize = context.pageSize;\nreturn api;\n\n","adaptor":"","messages":{},"dataType":"json"},"bulkActions":[],"itemActions":[],"perPageAvailable":[10],"messages":{},"features":[],"filter":{"title":"查询条件","body":[{"type":"group","body":[{"type":"input-datetime","label":"开始时间","name":"startTime","placeholder":"请选择日期以及时间","valueFormat":"YYYY-MM-DD HH:mm:ss","displayFormat":"YYYY-MM-DD HH:mm:ss","minDate":"","maxDate":"","value":"","id":"u:cdf9e0d27995"},{"type":"input-datetime","label":"结束时间","name":"overTime","placeholder":"请选择日期以及时间","valueFormat":"YYYY-MM-DD HH:mm:ss","displayFormat":"YYYY-MM-DD HH:mm:ss","minDate":"","maxDate":"","value":"","id":"u:349bf7e474e5"},{"type":"input-text","name":"bizId","label":"业务标识=","placeholder":"=匹配","id":"u:b7340265073c"},{"type":"input-text","name":"bizIdLike","label":"业务标识包含","placeholder":"模糊查询","id":"u:fad1b1ead5cd"},{"type":"input-text","label":"入参","name":"paramsJson","placeholder":"模糊查询","size":"md","id":"u:b8ccb3351d03"}],"id":"u:a0d2616960ea"},{"type":"select","label":"是否正常","name":"success","options":[{"label":"全部","value":"-1"},{"label":"正常","value":"1"},{"label":"异常","value":"0"}],"id":"u:585b8f1e4d14","multiple":false,"value":"-1"},{"type":"input-text","label":"消息","name":"message","id":"u:a1e3b2836567"},{"type":"select","label":"是否完成","name":"isOver","options":[{"label":"全部","value":"-1"},{"label":"已完成","value":"1"},{"label":"未完成","value":"0"}],"id":"u:640af92e3b4a","multiple":false,"value":"-1"},{"type":"select","label":"是否异步","name":"isAsync","options":[{"label":"全部","value":"-1"},{"label":"异步","value":"1"},{"label":"同步","value":"0"}],"id":"u:f3907951a8a9","multiple":false,"value":"-1"},{"type":"select","label":"筛选实例","name":"isParent","options":[{"label":"全部","value":"all"},{"label":"入口实例","value":"main"}],"id":"u:01664502ef99","multiple":false,"value":"main"},{"type":"input-text","name":"logicId","label":"逻辑编号","placeholder":"=匹配","id":"u:9d34f5fca978"},{"type":"input-text","label":"逻辑名称","name":"logicName","placeholder":"模糊查询","id":"u:b6232a9e3584"},{"type":"input-text","label":"环境","name":"env","id":"u:2ba007df093a"},{"type":"button","label":"查询","id":"u:238b22b12391","onEvent":{"click":{"actions":[{"componentId":"u:5b5ba66d9fad","ignoreError":false,"actionType":"submit","outputVar":"submitResult"}]}},"level":"primary","style":{"width":100}}],"id":"u:5b5ba66d9fad","actions":[{"type":"submit","label":"搜索","primary":true,"id":"u:c1b7db6d6cc4"}],"feat":"Insert","wrapWithPanel":false},"perPageField":"pageSize","id":"u:b7f9bcdb1ead","headerToolbar":[{"type":"bulk-actions"},{"type":"button","tpl":"内容","wrapperComponent":"","id":"u:86171ee1ff9e","label":"重试运行超时实例","level":"primary","onEvent":{"click":{"weight":0,"actions":[{"ignoreError":false,"actionType":"dialog","dialog":{"type":"dialog","body":[{"type":"grid","columns":[{"body":[{"id":"u:21eaf5f46a38","type":"form","title":"表单","mode":"horizontal","dsType":"api","feat":"Insert","actions":[{"type":"button","label":"提交","onEvent":{"click":{"actions":[{"actionType":"submit","componentId":"u:21eaf5f46a38"}]}},"level":"primary","id":"u:663449e4bcb7"}],"resetAfterSubmit":false,"body":[{"name":"timeout","label":"超时时间（秒）","type":"input-number","id":"u:0c8552f26c06","keyboard":true,"step":1,"value":30}],"closeDialogOnSubmit":false,"api":{"url":"/api/runtime/logic/v1/retry-longtime-running-biz?timeout=${timeout}","method":"post","requestAdaptor":"","adaptor":"","messages":{},"dataType":"json"},"onEvent":{"submitSucc":{"weight":0,"actions":[{"ignoreError":false,"actionType":"custom","args":{},"script":"/* 自定义JS使用说明：\n  * 1.动作执行函数doAction，可以执行所有类型的动作\n  * 2.通过上下文对象context可以获取当前组件实例，例如context.props可以获取该组件相关属性\n  * 3.事件对象event，在doAction之后执行event.stopPropagation();可以阻止后续动作执行\n\n*/\n\nconsole.log('event.data')\nconsole.log(event.data)"},{"componentId":"u:80598135e93b","ignoreError":false,"actionType":"setValue","args":{"value":{"data":"${event.data.result.data}"}}}]}}}],"id":"u:e141535dd636","md":4},{"body":[{"type":"service","body":[{"type":"table","columns":[{"type":"tpl","name":"logicLog","label":"编排Id","id":"u:a841cf098bfc","tpl":"${logicLog.logicId}"},{"type":"tpl","name":"logicLog","label":"业务标识(BizId)","tpl":"${logicLog.bizId}","id":"u:c328f57f11cd"},{"label":"消息","name":"msg","type":"text","id":"u:06f35d0dcde0"},{"label":"是否成功","name":"success","type":"status"},{"type":"text","name":"data","label":"返回数据","id":"u:408bfd29f3d8"}],"id":"u:0a358ffeffee","source":"${data}"}],"id":"u:80598135e93b","data":{"data":[]},"dsType":"api"}],"id":"u:6fafaa9169b7"}],"id":"u:f5c7986223c5"}],"showCloseButton":true,"showErrorMsg":true,"showLoading":true,"className":"app-popover :AMISCSSWrapper","id":"u:d1757aeb4bae","closeOnOutside":true,"closeOnEsc":true,"draggable":false,"title":"重试超时运行实例","hideActions":true,"actions":[{"type":"button","actionType":"cancel","label":"取消"},{"type":"button","actionType":"confirm","label":"确定","primary":true}],"size":"lg"}}]}}}],"autoFillHeight":false,"filterColumnCount":3,"initFetch":false,"mode":"table","columns":[{"type":"operation","label":"操作","buttons":[{"type":"button","id":"u:aa8be647c7a7","actionType":"url","url":"/debug/logic/instance/${id}","blank":true,"label":"查看","level":"light"},{"label":"","type":"dropdown-button","trigger":"hover","buttons":[{"type":"button","label":"编辑","actionType":"dialog","id":"u:0a5becd450b7","editorSetting":{"behavior":"update"},"dialog":{"title":"编辑","body":[{"type":"form","api":"/api/ide/logic-instance/edit/${id}/version","body":[{"label":"逻辑版本","name":"version","copyable":true,"id":"u:865cea37bead","type":"input-text","clearable":true}],"id":"u:5f5074a4a304","actions":[{"type":"submit","label":"提交","primary":true}],"feat":"Insert"}],"id":"u:6dab996c3830","actions":[{"type":"button","actionType":"cancel","label":"取消","id":"u:e9933956daa3"},{"type":"button","actionType":"confirm","label":"确定","primary":true,"id":"u:95cbdb2de63e"}]},"icon":"fa-solid fa-pen"},{"type":"button","label":"错误重试","actionType":"ajax","confirmText":"确定要进行错误重试？","icon":"fa-solid fa-rotate-right","api":{"method":"post","url":"${envs.CUSTOM_RETRY_URL?envs.CUSTOM_RETRY_URL:'/api/runtime/logic/v1/retry-error-biz'}/${logicId}/${bizId}","dataType":"json"},"id":"u:aaa293a3d35d"},{"type":"button","label":"停止执行","actionType":"ajax","confirmText":"确定要停止实例运行？实例将在最近的等待点执行后中止。","icon":"fa-regular fa-hand","api":{"method":"delete","url":"/api/runtime/lockKey/setBizStopping/${logicId}:${bizId}","messages":{"success":"操作成功，请等待实例中止！"}}},{"type":"button","label":"删除","icon":"fa-regular fa-trash-can","actionType":"ajax","confirmText":"确定要删除实例？删除实例会丢失业务标识的状态数据！","api":{"method":"delete","url":"/api/ide/logic-instance/delete/${id}","adaptor":"","messages":{},"dataType":"json"},"editorSetting":{"behavior":"delete"},"id":"u:a7bab231eac6","size":"sm"}],"id":"u:77d79c566cd1","level":"link","icon":"fa fa-ellipsis-h","hideCaret":true}],"id":"u:c9c0dcf14cc6","width":110},{"name":"createTime","label":"创建时间","type":"datetime","id":"u:4e9994a54093","placeholder":"-","remark":"最近一次执行的开始时间","displayFormat":"YYYY-MM-DD HH:mm:ss.SSS"},{"name":"startTime","label":"最近开始","type":"datetime","id":"u:2d2a5bf8b778","placeholder":"-","remark":"最近一次执行的开始时间","displayFormat":"YYYY-MM-DD HH:mm:ss.SSS"},{"name":"stopTime","label":"最近停止","type":"datetime","id":"u:6a80e6e3139f","placeholder":"-","remark":"最近一次执行停止时间","displayFormat":"YYYY-MM-DD HH:mm:ss.SSS","toggled":false},{"name":"duration","label":"调用时长","type":"number","id":"u:efc04e8a5973","placeholder":"-","remark":"最近一次调用持续的毫秒数"},{"name":"serverTime","label":"数据库更新","type":"datetime","id":"u:02af150627bb","placeholder":"-","remark":"数据库更新时间，由数据库生成","toggled":false},{"type":"text","label":"逻辑名称","name":"logicName","copyable":true,"id":"u:92462628de67"},{"type":"text","label":"业务标识（bizId)","name":"bizId","id":"u:416807755848","copyable":true},{"name":"retryTimes","label":"重试次数","type":"number","id":"u:efcede5b1ad7","placeholder":"-"},{"name":"isRunning","label":"状态","type":"status","id":"u:ee3693ac3f3f","source":{"0":{"label":"停止","icon":"","color":"#000"},"1":{"label":"执行中","icon":"rolling","color":"#000"}},"placeholder":"-"},{"name":"isAsync","label":"是否异步","type":"text","placeholder":"-"},{"type":"text","label":"待执行","name":"nextName","id":"u:66aeb4fe875a","levelExpand":0,"copyable":true},{"name":"success","label":"是否正常","type":"status","id":"u:e0c67231bd26","placeholder":"-","source":{"0":{"label":"异常","icon":"fail","color":"#00CD66"},"1":{"label":"正常","icon":"success","color":"#000"}}},{"type":"text","label":"最近消息","name":"message","id":"u:b88fe585f7a2","copyable":true},{"type":"status","label":"是否完成","name":"isOver","id":"u:9fa4fccc213a","placeholder":"-","source":{"0":{"label":"未完成","icon":"far fa-clock","color":"#00CD66"},"1":{"label":"完成","icon":"success","color":"#000"}}},{"type":"text","label":"当前入参","id":"u:7376cb630fb4","name":"paramsJson","copyable":true,"levelExpand":0,"placeholder":"-","quickEdit":{"type":"json-editor","saveImmediately":{"api":{"method":"post","url":"/api/ide/logic-instance/edit/${id}/paramsJson"}}}},{"name":"env","label":"env","type":"text","id":"u:3b2e255ab5c3","toggled":false},{"type":"text","label":"逻辑编号","name":"logicId","copyable":true,"id":"u:92462628de67"},{"type":"text","label":"父业务标识","name":"parentBizId","copyable":true,"id":"u:2adb534009b3"},{"type":"text","label":"父逻辑编号","name":"parentLogicId","copyable":true,"id":"u:8a9681bb9a0c"},{"name":"version","label":"逻辑版本","id":"u:977c6fb180f6","type":"text","placeholder":"-","toggled":false,"copyable":true,"quickEdit":false},{"type":"text","label":"实例编号","id":"u:5f39a0127155","name":"id","placeholder":"-","toggled":false}]}],"asideResizor":false,"pullRefresh":{"disabled":true},"regions":["body"],"id":"u:a76dd539e5bf","editorState":"default"}