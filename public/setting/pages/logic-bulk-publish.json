{"type":"page","body":[{"id":"u:2e00f2d78673","type":"form","title":"选择同步环境","mode":"horizontal","dsType":"api","feat":"Insert","body":[{"type":"radios","label":"发布环境","name":"host","id":"u:d645241b993d","source":"${PUBLISHED_IDE_HOSTS}","labelField":"name","valueField":"name","selectFirst":true,"multiple":false}],"actions":[{"type":"button","label":"比较online配置差异","onEvent":{"click":{"actions":[{"actionType":"submit","componentId":"u:2e00f2d78673"}]}},"level":"primary","id":"u:2e0abb9d94e1","disabledOnAction":false}],"resetAfterSubmit":true,"onEvent":{"submit":{"weight":0,"actions":[{"componentId":"u:8f20a85fc46f","ignoreError":false,"actionType":"setValue","args":{"value":{"hostName":"${host}","ids":[]}}},{"componentId":"u:8f20a85fc46f","groupType":"component","actionType":"reload","dataMergeMode":"override"}]}},"debug":false,"labelAlign":"left"},{"type":"service","body":[{"type":"input-group","name":"input-group","label":"","body":[{"type":"button","label":"批量同步(${ids.length})","behavior":"BulkDelete","level":"warning","className":"mb-5","confirmText":"确认要批量同步【${ids.length}】个编排到【${hostName}】?配置会同时更新DB和文件配置。","disabledOn":"${ids != null && ids.length < 1}","onEvent":{"click":{"actions":[{"actionType":"loop","args":{"loopName":"ids"},"children":[{"actionType":"ajax","args":{"api":{"method":"post","url":"/api/ide/publish/logic/to-ide/${id}/${hostName}","messages":{"success":"发布成功！"}}}}]}]}},"id":"u:b64215961e3d","visibleOn":"${ids}","disabledOnAction":false},{"type":"button","label":"热更新(${ids.length})","behavior":"BulkDelete","level":"danger","className":"mb-5","confirmText":"热更新会让配置立刻生效，不需要重启系统，确认实时更新【${ids.length}】个编排到【${hostName}】??配置会同时更新DB和文件配置，并清空离线配置缓存，使配置实时生效。","disabledOn":"${ids != null && ids.length < 1}","onEvent":{"click":{"actions":[{"actionType":"loop","args":{"loopName":"ids"},"children":[{"actionType":"ajax","args":{"api":{"method":"post","url":"/api/ide/publish/logic/to-ide/${id}/${hostName}?isHotUpdate=true","messages":{"success":"发布成功！"}}}}]}]}},"id":"u:b2a2a13c2294","visibleOn":"${ids}","disabledOnAction":false,"themeCss":{"className":{"padding-and-margin:default":{"marginLeft":"10px"}}}}],"id":"u:47d2571c4868"},{"type":"tabs","tabs":[{"title":"${diffType}(${children.length})","body":[{"type":"table","columns":[{"type":"mapping","name":"diffType","map":{"新增":"<span class='text-md label label-success'>新增</span>","更新":"<span class='text-md label label-warning'>更新</span>","*":"<span class='text-md label label-default'>无变更</span>","低于远程环境":"<span class='text-md label label-danger'>低于远程环境</span>"},"id":"u:e2d3ead89ecb","placeholder":"-","label":"变更类型"},{"type":"text","name":"id","id":"u:54cb87dee4c8","label":"编号"},{"type":"text","name":"name","id":"u:ec777186904c","label":"名称"},{"type":"tpl","name":"version","tpl":"本地:${localVersion}<br/>远程:${remoteVersion}","id":"u:0fc049d78eed","label":"版本号"},{"type":"tpl","name":"updateTime","tpl":"本地:${localVersionUpdateTime}<br/>远程:${remoteVersionUpdateTime}","id":"u:eb9baf6f520d","label":"更新时间"}],"id":"u:5dc1cf7e429b","selectable":true,"source":"${children}","onEvent":{"selectedChange":{"weight":0,"actions":[{"componentId":"u:8f20a85fc46f","ignoreError":false,"actionType":"setValue","args":{"value":{"ids":"${event.data.selectedItems}"}}}]}},"multiple":true}],"id":"u:ff5d1d404194"}],"id":"u:9692832194d0","source":"${tabs}","visibleOn":"${tabs}"}],"id":"u:8f20a85fc46f","api":{"url":"/api/ide/published/logics/diff","method":"post","requestAdaptor":"","adaptor":"var treeMap = {\n    '新增': [],\n    '更新': [],'低于远程环境':[],'无变更': []\n}\nvar data = payload.data;\nfor (i = 0; i < data.length; i++) {\n    treeMap[data[i].diffType].push(data[i])\n}\nvar treeData = []\nObject.keys(treeMap).forEach(k => {\n    treeData.push({\n        id: k,\n        diffType: k,\n        children: treeMap[k]\n    })\n})\n console.log(treeData); return {\n    status: payload.code,\n    data: {\n        tabs: treeData\n    }\n}","messages":{},"dataType":"json","data":{"queryInput":{"page":1,"pageSize":10000},"hostName":"${hostName}"},"sendOn":"this.hostName"},"initFetchSchema":false,"dsType":"api"}],"asideResizor":true,"pullRefresh":{"disabled":true},"regions":["body"],"error":{"code":0},"status":0,"id":"u:a406dbc1156c","aside":[],"asideMinWidth":160,"asideMaxWidth":450,"asideClassName":"w-56","initApi":{"url":"/api/runtime/env","method":"get"},"data":{"hostName":""}}