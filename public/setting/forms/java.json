{"type":"page","body":[{"type":"form","id":"u:8f6dc62b29e2","mode":"normal","title":"节点配置","body":[{"type":"input-text","id":"u:30db4470577d","label":"名称","name":"name"},{"type":"select","id":"u:47dddf5a2395","label":"类路径","name":"url","multiple":false,"searchable":true,"source":{"url":"${runtime?`papi/${runtime}/api/ide/asset/v1/java/classes`:'/api/ide/asset/v1/java/classes'}","method":"get","requestAdaptor":"","adaptor":"return {\n    status: 0,\n    data: {\n        options: payload.data\n    }\n}","messages":{}},"labelField":"value","valueField":"value","onEvent":{"change":{"weight":0,"actions":[{"componentId":"u:c6c9ec0a41f6","actionType":"reload","groupType":"component"}]}}},{"type":"select","label":{"type":"wrapper","id":"u:8cc4049e012f","body":[{"type":"tpl","id":"u:58107c87fedb","tpl":"方法名","onEvent":{"click":{"actions":[{"actionType":"copy","args":{"copyFormat":"text/plain","content":"${method}"}}]}},"className":"mr-2"},{"type":"icon","id":"u:e107795c10cc","icon":"fa-sharp fa-thin fa-copy","className":"text-xl","onEvent":{"click":{"actions":[{"actionType":"custom","ignoreError":false,"script":"/* 自定义JS使用说明：\n  * 1.动作执行函数doAction，可以执行所有类型的动作\n  * 2.通过上下文对象context可以获取当前组件实例，例如context.props可以获取该组件相关属性\n  * 3.事件对象event，在doAction之后执行event.stopPropagation();可以阻止后续动作执行\n*/\nconst msg = context.props.data.method;\nconsole.log('context')\nconsole.log(context)\ndoAction({\n  actionType: 'copy',\n  args: {\n    content: msg.split(\"(\")[0]\n  }\n});\n"}]}}}],"size":"xs","style":{"position":"static","display":"inline","overflowX":"visible","margin":"0","textAlign":"left"},"isFixedHeight":false,"isFixedWidth":false,"onEvent":{"click":{"actions":[{"actionType":"copy","args":{"copyFormat":"text/plain","content":"${method}"}}]}}},"id":"u:c6c9ec0a41f6","name":"method","multiple":false,"searchable":true,"source":{"url":"${runtime?`/papi/${runtime}/api/ide/asset/v1/java/class/${url}/methods`:`/api/ide/asset/v1/java/class/${url}/methods`}","method":"get","requestAdaptor":"","adaptor":"let methods = payload.data;\nif (methods && methods.length > 0) {\n    methods.forEach(m => {\n        let paramsStr = '';\n        m.parameters.forEach(p => {\n            paramsStr = paramsStr + `,${p.name}`;\n        })\n        if (paramsStr.length > 1) {\n            m.nameWithParam = `${m.name}(${paramsStr.substring(1)})`\n        } else {\n            m.nameWithParam = `${m.name}()`\n        }\n    });\n}\nreturn {\n    status: 0,\n    data: {\n        value: api.context.method,\n        options: methods\n    }\n}","messages":{},"silent":true,"sendOn":"this.url?.length>0"},"labelField":"nameWithParam","valueField":"nameWithParam","removable":false,"editable":false,"clearable":true,"onEvent":{"change":{"weight":0,"actions":[{"ignoreError":false,"actionType":"custom","script":"/* 自定义JS使用说明：\n  * 1.动作执行函数doAction，可以执行所有类型的动作\n  * 2.通过上下文对象context可以获取当前组件实例，例如context.props可以获取该组件相关属性\n  * 3.事件对象event，在doAction之后执行event.stopPropagation();可以阻止后续动作执行\n*/\nlet body = {};\nlet params = []\nconsole.log('method:valuechange:event.data.selectedItems')\nconsole.log(event.data.selectedItems)\nif (event.data.selectedItems && event.data.selectedItems.parameters) {\n  console.log('method:event.data.selectedItems')\n  console.log(event.data.selectedItems)\n  params = event.data.selectedItems.parameters;\n  event.data.selectedItems.parameters.forEach(p => {\n    let anno = p.typeAnnotation;\n    let parValue = null;\n    if (anno.typeKind == 'reference' && anno.properties && anno.properties.length > 0) {\n      parValue = {};\n      anno.properties.forEach(prop => {\n        parValue[prop.name] = JSON.parse(prop.defaultValue);\n      })\n    }\n    body[p.name] = parValue;\n  })\n}\ndoAction({\n  actionType: 'setValue',\n  componentId: 'item_body',\n  args: {\n    value: `return ` + JSON.stringify(body, null, 2)\n  }\n});\ndoAction({\n  actionType: 'setValue',\n  componentId: 'item_params',\n  args: {\n    value: params\n  }\n});\n\n"}]}},"showInvalidMatch":false,"selectFirst":false,"value":""},{"type":"editor","id":"item_body","label":"请求参数","name":"body","language":"javascript","value":"","description":"js代码块，return {}"},{"type":"editor","id":"u:2f0a85d8140a","label":"事务组编号","name":"tranGroupId","editorState":"default","placeholder":"相邻且相同的编号会使用同一个事务","language":"javascript","size":"sm","description":"支撑常量、变量，如t1、_par.outType"},{"type":"editor","label":"将返回数据赋值给哪个参数","name":"returnAccept","language":"javascript","size":"sm","id":"u:2287ffd80664"},{"type":"textarea","label":"备注","name":"memo","id":"u:dc0abcb09330","minRows":3,"maxRows":20},{"type":"static-json","id":"item_params","label":"参数声明","quickEdit":false,"popOver":false,"copyable":false,"name":"params"}],"onEvent":{"submitSucc":{"actions":[{"actionType":"broadcast","args":{"eventName":"formSubmited"},"data":"${event.data}"}]}},"actions":[{"type":"submit","label":"提交","primary":true,"id":"u:d2d02ca51bfc"}],"feat":"Insert","name":"form1","dsType":"api","debug":false}],"asideResizor":false,"pullRefresh":{"disabled":true},"regions":["body"],"error":{"code":0},"status":0,"id":"u:e339c263ac5e","name":"page1"}